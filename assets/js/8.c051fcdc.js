(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{352:function(t,s,a){t.exports=a.p+"assets/img/team-switcher.fee368df.png"},361:function(t,s,a){"use strict";a.r(s);var e=a(40),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"команды"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#команды"}},[t._v("#")]),t._v(" Команды")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#вступление"}},[t._v("Вступление")])]),e("li",[e("a",{attrs:{href:"#создание-удаление-команды"}},[t._v("Создание /Удаление команды")]),e("ul",[e("li",[e("a",{attrs:{href:"#представления-страницы"}},[t._v("Представления / Страницы")])]),e("li",[e("a",{attrs:{href:"#деиствия"}},[t._v("Действия")])])])]),e("li",[e("a",{attrs:{href:"#проверка-пользовательских-команд"}},[t._v("Проверка пользовательских команд")]),e("ul",[e("li",[e("a",{attrs:{href:"#текущая-команда"}},[t._v("Текущая команда")])]),e("li",[e("a",{attrs:{href:"#объект-команды"}},[t._v("Объект команды")])])])]),e("li",[e("a",{attrs:{href:"#управление-участниками"}},[t._v("Управление участниками")]),e("ul",[e("li",[e("a",{attrs:{href:"#управление-участниками-представления-страницы"}},[t._v("Управление участниками Представления / Страницы")])]),e("li",[e("a",{attrs:{href:"#управление-участниками-деиствия"}},[t._v("Управление участниками Действия")])]),e("li",[e("a",{attrs:{href:"#роли-разрешения"}},[t._v("Роли / Разрешения")])]),e("li",[e("a",{attrs:{href:"#авторизация"}},[t._v("Авторизация")])])])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"вступление"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#вступление"}},[t._v("#")]),t._v(" Вступление")]),t._v(" "),e("p",[t._v("Если Вы установили Jetstream с помощью параметра "),e("code",[t._v("--teams")]),t._v(", Ваше приложение будет построено для поддержки создания команды и управления ею.")]),t._v(" "),e("p",[t._v("Командные функции Jetstream позволяют каждому зарегистрированному пользователю создавать несколько команд и входить в них. По умолчанию каждый зарегистрированный пользователь будет входить в «Персональную» команду. Например, если пользователь с именем «Sally Jones» создает новую учетную запись, он будет назначен в команду с именем "),e("code",[t._v("Sally's Team")]),t._v(". После регистрации пользователь может переименовать эту команду или создать дополнительные команды.")]),t._v(" "),e("p",[t._v("! "),e("a",{attrs:{href:"./../../assets/img/teams.png"}},[t._v("Скриншот команд Laravel")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Jetstream Команды")]),t._v(" "),e("p",[t._v("Каркас и опции команды Jetstream могут работать не для всех приложений. Если это не работает для Вашего варианта использования, смело создавайте приложение Jetstream, не основанное на команде, и самостоятельно добавляйте командные функции в свое приложение.")])]),t._v(" "),e("h2",{attrs:{id:"создание-удаление-команды"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#создание-удаление-команды"}},[t._v("#")]),t._v(" Создание /Удаление команды")]),t._v(" "),e("p",[t._v("Доступ к представлению создания команды осуществляется через раскрывающееся меню навигации пользователя в правом верхнем углу.")]),t._v(" "),e("h3",{attrs:{id:"представления-страницы"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#представления-страницы"}},[t._v("#")]),t._v(" Представления / Страницы")]),t._v(" "),e("p",[t._v("При использовании стека Livewire представление создания команды отображается с использованием шаблона Blade "),e("code",[t._v("resources/views/teams/create-team-form.blade.php")]),t._v(". При использовании стека Inertia это представление отображается с использованием шаблона "),e("code",[t._v("resources/js/Pages/Teams/CreateTeamForm.vue")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"деиствия"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#деиствия"}},[t._v("#")]),t._v(" Действия")]),t._v(" "),e("p",[t._v("Логику создания и удаления команды можно настроить, изменив соответствующие классы действий в Вашем каталоге "),e("code",[t._v("app/Actions/Jetstream")]),t._v(". Эти действия включают "),e("code",[t._v("CreateTeam")]),t._v(", "),e("code",[t._v("UpdateTeamName")]),t._v(" и "),e("code",[t._v("DeleteTeam")]),t._v(". Каждое из этих действий вызывается, когда соответствующая задача выполняется пользователем в пользовательском интерфейсе приложения. Вы можете изменять эти действия по мере необходимости в зависимости от потребностей Вашего приложения.")]),t._v(" "),e("h2",{attrs:{id:"проверка-пользовательских-команд"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#проверка-пользовательских-команд"}},[t._v("#")]),t._v(" Проверка пользовательских команд")]),t._v(" "),e("p",[t._v("Доступ к информации о командах пользователя можно получить с помощью методов, предоставляемых трейтом "),e("code",[t._v("Laravel\\Jetstream\\HasTeams")]),t._v(". Этот трейт автоматически применяется к модели Вашего приложения "),e("code",[t._v("App\\Models\\User")]),t._v(" во время установки Jetstream. Этот трейт предоставляет множество полезных методов, которые позволяют Вам проверять команды пользователя:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ к выбранной в данный момент команде пользователя...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("currentTeam")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Laravel\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Jetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Team")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ ко всем командам (включая собственные команды), к которым принадлежит пользователь...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("allTeams")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Illuminate\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Support"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ ко всем командам, принадлежащим пользователю...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("ownedTeams")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Illuminate\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Database"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Eloquent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ ко всем командам, к которым пользователь принадлежит, но не владелец...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("teams")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Illuminate\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Database"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Eloquent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Доступ к "личной" команде пользователя...')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("personalTeam")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Laravel\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Jetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Team")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение, владеет ли пользователь данной командой...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ownsTeam")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение принадлежности пользователя к определенной команды...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("belongsToTeam")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Получение роли, назначенной пользователю в команде...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("teamRole")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Laravel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Jetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Role")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение наличия у пользователя данной роли в данной команде...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasTeamRole")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'admin'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ к массиву всех разрешений, имеющихся у пользователя для данной команде...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("teamPermissions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("array")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение, имеет ли пользователь данное разрешение рабочей команды...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasTeamPermission")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'server:create'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n")])])]),e("h3",{attrs:{id:"текущая-команда"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#текущая-команда"}},[t._v("#")]),t._v(" Текущая команда")]),t._v(" "),e("p",[t._v("У каждого пользователя в приложении Jetstream есть «текущая команда». Это команда, для которой пользователь активно просматривает ресурсы. Например, если Вы создаете приложение-календарь, Ваше приложение будет отображать предстоящие события календаря для текущей команды пользователя.")]),t._v(" "),e("p",[t._v("Вы можете получить доступ к текущей команде пользователя, используя отношение Eloquent "),e("code",[t._v("$user->currentTeam")]),t._v(". Эту команду можно использовать для анализа других Ваших запросов Eloquent:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" App\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Models"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Calendar")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("where")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'team_id'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("currentTeam")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("id")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Пользователь может переключить свою текущую команду через раскрывающееся меню профиля пользователя, доступное на панели навигации Jetstream.")]),t._v(" "),e("p",[e("img",{attrs:{src:a(352),alt:"Скриншот смены команды"}})]),t._v(" "),e("h3",{attrs:{id:"объект-команды"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#объект-команды"}},[t._v("#")]),t._v(" Объект команды")]),t._v(" "),e("p",[t._v("Объект команды, доступ к которому осуществляется через "),e("code",[t._v("$user->currentTeam")]),t._v(" или через запросы Eloquent, предоставляет множество полезных методов для проверки атрибутов и взаимосвязей команды:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Доступ к владельцу команды...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("owner")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Получить всех пользователей команды, включая владельца...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("allUsers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Illuminate\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Database"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Eloquent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Получить всех пользователей команды, исключая владельца...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("users")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Illuminate\\"),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Database"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Eloquent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение, является ли данный пользователь членом команды...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasUser")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение, есть ли в команде участник с данным адресом электронной почты...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasUserWithEmail")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$emailAddress")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Определение, является ли данный пользователь членом команды с данным разрешением...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("userHasPermission")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$permission")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bool\n")])])]),e("h2",{attrs:{id:"управление-участниками"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#управление-участниками"}},[t._v("#")]),t._v(" Управление участниками")]),t._v(" "),e("p",[t._v("Участники команды могут быть добавлены и удалены через представление Jetstream «Настройки команды». Логика серверной части, которая управляет этими действиями, может быть настроена путем изменения соответствующих действий, таких как класс "),e("code",[t._v("App\\Actions\\Jetstream\\AddTeamMember")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"управление-участниками-представления-страницы"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#управление-участниками-представления-страницы"}},[t._v("#")]),t._v(" Управление участниками Представления / Страницы")]),t._v(" "),e("p",[t._v("При использовании стека Livewire представление менеджера членов команды отображается с использованием блейд-шаблона "),e("code",[t._v("resources/views/teams/team-member-manager.blade.php")]),t._v(". При использовании стека Inertia это представление отображается с использованием шаблона "),e("code",[t._v("resources/js/Pages/Teams/TeamMemberManager.vue")]),t._v(". Как правило, эти шаблоны не требуют настройки.")]),t._v(" "),e("h3",{attrs:{id:"управление-участниками-деиствия"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#управление-участниками-деиствия"}},[t._v("#")]),t._v(" Управление участниками Действия")]),t._v(" "),e("p",[t._v("Логика добавления членов команды может быть настроена путем изменения класса действия "),e("code",[t._v("App\\Actions\\Jetstream\\AddTeamMember")]),t._v(". Метод класса "),e("code",[t._v("add")]),t._v(" вызывается с текущим аутентифицированным пользователем, экземпляром "),e("code",[t._v("Laravel\\Jetstream\\Team")]),t._v(", адресом электронной почты пользователя, добавляемого в команду, и ролью (если применимо) пользователя, добавляемого в команду.")]),t._v(" "),e("p",[t._v("Это действие отвечает за проверку того, что пользователь действительно может быть добавлен в команду, а затем за добавление пользователя в команду. Вы можете настроить это действие в соответствии с потребностями Вашего конкретного приложения.")]),t._v(" "),e("h3",{attrs:{id:"роли-разрешения"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#роли-разрешения"}},[t._v("#")]),t._v(" Роли / Разрешения")]),t._v(" "),e("p",[t._v("Каждому участнику команды, добавленному в команду, может быть назначена определенная роль, и каждой роли назначается набор разрешений. Разрешения ролей определяются в Вашем приложении "),e("code",[t._v("JetstreamServiceProvider")]),t._v(" с помощью метода "),e("code",[t._v("Jetstream::role")]),t._v(". Этот метод принимает «слаг» для роли, удобное для пользователя имя роли, разрешения роли и описание роли. Эта информация будет использоваться для отображения роли в представлении управления членами команды:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[t._v("Jetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("defaultApiTokenPermissions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'read'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nJetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("role")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'admin'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'Administrator'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'create'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'read'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'update'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'delete'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'Пользователи-администраторы могут выполнять любые действия.'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nJetstream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("role")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'editor'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'Editor'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'read'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'create'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'update'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'Пользователи-редакторы могут читать, создавать и обновлять.'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Поддержка API Команды")]),t._v(" "),e("p",[t._v("Когда Jetstream устанавливается с поддержкой команды, доступные разрешения API автоматически выводятся путем объединения всех уникальных разрешений, доступных для ролей. Следовательно, отдельный вызов метода "),e("code",[t._v("Jetstream::permissions")]),t._v(" не требуется.")])]),t._v(" "),e("h3",{attrs:{id:"авторизация"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#авторизация"}},[t._v("#")]),t._v(" Авторизация")]),t._v(" "),e("p",[t._v("Конечно, Вам понадобится способ авторизации того, что входящие запросы, инициированные членом команды, могут действительно выполняться этим пользователем. Разрешения команды пользователя могут быть проверены с помощью метода "),e("code",[t._v("hasTeamPermission")]),t._v(", доступного через трейт "),e("code",[t._v("Laravel\\Jetstream\\HasTeams")]),t._v(". Нет необходимости проверять роль пользователя. Вам нужно только убедиться, что у пользователя есть определенные разрешения. Роли - это просто презентационная концепция, используемая для группировки детализированных разрешений. Обычно вызовы этого метода приложения выполняются в "),e("a",{attrs:{href:"https://laravel.com/docs/authorization",target:"_blank",rel:"noopener noreferrer"}},[t._v("политиках авторизации"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasTeamPermission")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'read'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Роль пользователя включает разрешение на "чтение"...')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"объединение-разрешении-команды-с-разрешениями-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#объединение-разрешении-команды-с-разрешениями-api"}},[t._v("#")]),t._v(" Объединение разрешений команды с разрешениями API")]),t._v(" "),e("p",[t._v("При создании приложения Jetstream, которое обеспечивает как поддержку API, так и поддержку команды, Вы должны проверить разрешения команды "),e("strong",[t._v("и")]),t._v(" разрешения токена API входящего запроса в политиках авторизации вашего приложения. Это важно, потому что токен API может иметь теоретическую способность выполнять действие, в то время как пользователю фактически не предоставлено это действие через разрешения своей команды:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * Определите, может ли пользователь просматривать.\n *\n * @param  \\App\\Models\\User  $user\n * @param  \\App\\Models\\Flight  $flight\n * @return bool\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("view")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("User "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Flight "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$flight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("belongsToTeam")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$flight")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n           "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasTeamPermission")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$flight")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("team")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'flight:view'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n           "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tokenCan")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'flight:view'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);