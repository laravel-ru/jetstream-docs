(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{369:function(t,s,a){"use strict";a.r(s);var n=a(40),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"примеры-форматирования"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#примеры-форматирования"}},[t._v("#")]),t._v(" Примеры форматирования")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Знаете ли Вы, что?")]),t._v(" "),a("p",[t._v("Laravel теперь предлагает Horizon, красивую панель управления и систему конфигурации для ваших очередей с поддержкой Redis. Ознакомьтесь с полной "),a("a",{attrs:{href:"/docs/%7B%7Bversion%7D%7D/horizon"}},[t._v("документацией Horizon")]),t._v(" для дополнительной информации.")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Что-то, что нужно помнить")]),t._v(" "),a("p",[t._v("Laravel теперь предлагает Horizon, красивую панель управления и систему конфигурации для ваших очередей с поддержкой Redis. Ознакомьтесь с полной "),a("a",{attrs:{href:"/docs/%7B%7Bversion%7D%7D/horizon"}},[t._v("документацией Horizon")]),t._v(" для дополнительной информации.")])]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("Будьте осторожны!")]),t._v(" "),a("p",[t._v("Laravel теперь предлагает Horizon, красивую панель управления и систему конфигурации для ваших очередей с поддержкой Redis. Ознакомьтесь с полной "),a("a",{attrs:{href:"/docs/%7B%7Bversion%7D%7D/horizon"}},[t._v("документацией Horizon")]),t._v(" для дополнительной информации.")])]),t._v(" "),a("p",[t._v("Очереди Laravel предоставляют унифицированный API для множества различных очередей, таких как Beanstalk, Amazon SQS, Redis или даже для реляционной базы данных. Очереди позволяют отложить обработку трудоемкой задачи, такой как отправка электронного письма, на более позднее время. Откладывание этих трудоемких задач резко ускоряет веб-запросы к Вашему приложению.")]),t._v(" "),a("p",[t._v("Файл конфигурации очереди хранится в "),a("code",[t._v("config/queue.php")]),t._v(". В этом файле вы найдете конфигурации подключения для каждого из драйверов очереди, включенных в структуру, которая включает базу данных, "),a("a",{attrs:{href:"https://kr.github.io/beanstalkd/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Beanstalkd"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://aws.amazon.com/sqs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon SQS"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://redis.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis"),a("OutboundLink")],1),t._v(" и синхронный драйвер, который немедленно выполняет задания (для локального использования). Также включен драйвер очереди "),a("code",[t._v("null")]),t._v(", который отбрасывает задания в очереди.")]),t._v(" "),a("h3",{attrs:{id:"подраздел"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#подраздел"}},[t._v("#")]),t._v(" Подраздел")]),t._v(" "),a("p",[t._v("Прежде чем приступить к работе с очередями Laravel, важно понять различие между «connections» и «queues». В Вашем конфигурационном файле "),a("code",[t._v("config/queue.php")]),t._v(" есть опция конфигурации "),a("code",[t._v("connections")]),t._v(". Этот параметр определяет конкретное соединение с серверной службой, такой как Amazon SQS, Beanstalk или Redis. Однако любое данное соединение очереди может иметь несколько «queues», которые могут рассматриваться как различные стеки или груды поставленных в очередь заданий.")]),t._v(" "),a("p",[t._v("Обратите внимание, что каждый пример конфигурации соединения в файле конфигурации "),a("code",[t._v("queue")]),t._v(" содержит атрибут "),a("code",[t._v("queue")]),t._v(". Это очередь по умолчанию, в которую будут отправляться задания при их отправке в определенное соединение. Другими словами, если Вы отправляете задание без явного определения очереди, в которую оно должно быть отправлено, задание будет помещено в очередь, которая определена в атрибуте "),a("code",[t._v("queue")]),t._v(" конфигурации соединения:")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Это задание отправляется в очередь по умолчанию...")]),t._v("\nJob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Это задание отправлено в очередь "электронных писем"...')]),t._v("\nJob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onQueue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'emails'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_4-и-уровень"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-и-уровень"}},[t._v("#")]),t._v(" 4-й уровень")]),t._v(" "),a("p",[t._v("Чтобы использовать драйвер очереди "),a("code",[t._v("database")]),t._v(", Вам понадобится таблица базы данных для хранения заданий. Чтобы сгенерировать миграцию, которая создает эту таблицу, запустите Artisan-команду "),a("code",[t._v("queue:table")]),t._v(". После того, как миграция будет создана, Вы можете перенести свою базу данных с помощью команды "),a("code",[t._v("migrate")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("php artisan queue:table\n\nphp artisan migrate\n")])])]),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Providers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Facades"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ServiceProvider")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Events"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("JobProcessed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Events"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("JobProcessing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AppServiceProvider")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceProvider")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Bootstrap any application services.\n     *\n     * @return void\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("boot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("before")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JobProcessing "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->connectionName")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->job")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->job->payload()")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("after")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JobProcessed "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->connectionName")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->job")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $event->job->payload()")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Register the service provider.\n     *\n     * @return void\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);