# Inertia

[[toc]]

## Вступление

Стек Inertia, предоставляемый Jetstream, использует [Vue.js](https://vuejs.org) в качестве языка шаблонов. Создание приложения Inertia очень похоже на создание типичного приложения Vue; однако Вы будете использовать маршрутизатор Laravel вместо маршрутизатора Vue. Inertia - это небольшая библиотека, которая позволяет Вам отображать однофайловые компоненты Vue из Вашего бэкэнда Laravel, предоставляя имя компонента и данные, которые должны быть перенесены в «свойства» этого компонента.

Другими словами, этот стек дает Вам всю мощь Vue.js без сложной маршрутизации на стороне клиента. Стек Inertia - отличный выбор, если Вам комфортно и нравится использовать Vue.js в качестве языка шаблонов. При использовании Inertia маршруты Вашего приложения будут отображать "страницу" Inertia. Это очень похоже на возвращение представления Laravel Blade:

```php
use Illuminate\Http\Request;
use Inertia\Inertia;

/**
 * Показать экран общих настроек профиля.
 *
 * @param  \Illuminate\Http\Request  $request
 * @return \Inertia\Response
 */
public function show(Request $request)
{
    return Inertia::render('Profile/Show', [
        'sessions' => $this->sessions($request)->all(),
    ]);
}
```

При использовании стека Inertia Jetstream обладает некоторыми уникальными функциями, о которых Вам следует знать. Мы обсудим каждую из этих функций ниже.

:::tip Документация Inertia

Перед использованием стека Inertia настоятельно рекомендуется просмотреть всю [документацию Inertia](https://inertiajs.com) или [перевод официальной документации Inertia](https://inertiajs.ru)
:::

## Компоненты

Когда мы создавали стек Jetstream Inertia, были созданы различные компоненты Vue (кнопки, панели, входы, модальные окна), чтобы помочь в обеспечении согласованности пользовательского интерфейса и простоте использования. Вы можете использовать или не использовать эти компоненты. Все эти компоненты находятся в каталоге Вашего приложения `resources/js/Jetstream`.

Вы можете получить представление о том, как использовать эти компоненты, просмотрев их использование на существующих страницах Jetstream, расположенных в каталоге Вашего приложения `resources/js/Pages`.

## Настройка рендеринга страницы Jetstream

Некоторые страницы Inertia в Jetstream, такие как `Teams/Show` и `Profile/Show`, отображаются внутри самого Jetstream. Однако Вам может потребоваться передать на эти страницы дополнительные данные при создании приложения. Следовательно, Jetstream позволяет настраивать данные / свойства, передаваемые на эти страницы, с помощью метода `Jetstream::inertia()->whenRendering`.

Этот метод принимает имя страницы, которую Вы хотите настроить и замыкание. Замыкание получит входящий HTTP-запрос и массив данных по умолчанию, которые обычно отправляются на страницу. Вы можете при необходимости настроить или добавить новые элементы массива к данным. Обычно Вы должны вызывать этот метод из метода `boot` Вашего класса `App\Providers\JetstreamServiceProvider`:

```php
use Illuminate\Http\Request;
use Laravel\Jetstream\Jetstream;

/**
 * Загрузка любых служб приложений.
 *
 * @return void
 */
public function boot()
{
    // ...

    Jetstream::inertia()->whenRendering(
        'Profile/Show',
        function (Request $request, array $data) {
            return array_merge($data, [
                // Пользовательские данные...
            ]);
        }
    );
}
```

:::tip Настройка просмотра аутентификации

Чтобы узнать, как настроить страницы Inertia, отображаемые связанными с аутентификацией маршрутами Jetstream, такими как вход, регистрация и сброс пароля, ознакомьтесь с [документацией по аутентификации](./../features/authentication.md#customizing-inertia-authentication-views).
:::

## Помощники формы / валидации

Чтобы сделать работу с формами и ошибками валидации более удобной, был создан NPM-пакет [laravel-jetstream](https://github.com/laravel/jetstream-js). Этот пакет устанавливается автоматически при использовании стека Jetstream Inertia.

Этот пакет добавляет новый метод `form` к объекту `$inertia`, к которому можно получить доступ через Ваши компоненты Vue. Метод `form` используется для создания нового объекта формы, который обеспечит легкий доступ к сообщениям об ошибках, а также к таким удобствам, как сброс состояния формы при успешной отправке формы:

```js
data() {
    return {
        form: this.$inertia.form({
            name: this.name,
            email: this.email,
        }, {
            bag: 'updateProfileInformation',
            resetOnSuccess: true,
        }),
    }
}
```

Форма может быть отправлена с использованием методов `post`, `put` или `delete`. Все данные, указанные при создании формы, будут автоматически включены в запрос. Кроме того, можно указать [Параметры запроса инерции](https://inertiajs.com/requests) или [перевод параметров запроса инерции](https://inertiajs.ru/requests):

```js
this.form.post('/user/profile-information', {
    preserveScroll: true
})
```

К сообщениям об ошибках формы можно получить доступ, используя метод `form.error`. Этот метод вернет первое доступное сообщение об ошибке для данного поля:

```html
<jet-input-error :message="form.error('email')" class="mt-2" />
```

Сглаженный список всех ошибок проверки можно получить с помощью метода `errors`. Этот метод может оказаться полезным при попытке отобразить сообщение об ошибке в виде простого списка:

```html
<li v-for="error in form.errors()">
    {{ error }}
</li>
```

Дополнительная информация о текущем состоянии формы доступна через методы `recentlySuccessful` и `processing`. Эти методы полезны для того, чтобы диктовать отключенные или "выполняющиеся" состояния пользовательского интерфейса:

```html
<jet-action-message :on="form.recentlySuccessful" class="mr-3">
    Сохранено.
</jet-action-message>

<jet-button :class="{ 'opacity-25': form.processing }" :disabled="form.processing">
    Сохранить
</jet-button>
```

Чтобы узнать больше об использовании помощников форм Jetstream Inertia, Вы можете просмотреть страницы Inertia, созданные во время установки Jetstream. Эти страницы находятся в каталоге Вашего приложения `resources/js/Pages`.

## Модальные

Стек Inertia в Jetstream также включает два модальных компонента: `DialogModal` и `ConfirmationModal`. `ConfirmationModal` может использоваться при подтверждении деструктивных действий, таких как удаление ресурсов, в то время как `DialogModal` является более общим модальным окном, которое можно использовать в любое время.

Чтобы проиллюстрировать использование модальных окон, рассмотрим следующее модальное окно, которое подтверждает, что пользователь желает удалить свою учетную запись:

```html
<jet-confirmation-modal :show="confirmingUserDeletion" @close="confirmingUserDeletion = false">
    <template #title>
        Удалить аккаунт
    </template>

    <template #content>
        Вы уверены, что хотите удалить свою учетную запись? После удаления Вашей учетной записи все ее ресурсы и данные будут удалены без возможности восстановления.
    </template>

    <template #footer>
        <jet-secondary-button @click.native="confirmingUserDeletion = false">
            Ничего
        </jet-secondary-button>

        <jet-danger-button class="ml-2" @click.native="deleteTeam" :class="{ 'opacity-25': form.processing }" :disabled="form.processing">
            Удалить аккаунт
        </jet-danger-button>
    </template>
</jet-confirmation-modal>
```

Как видите, состояние открытия / закрытия модального окна определяется свойством `show`, которое объявлено в компоненте. Содержимое модального окна может быть определено путем гидратации трех слотов: `title`, `content` и `footer`.
